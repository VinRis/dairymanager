<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dairy Manager Pro</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="theme-color" content="#2ecc71">
    <!-- Libraries -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="light-mode">
    <!-- Welcome Screen -->
    <section id="welcome-screen" class="screen active">
        <div class="welcome-content">
            <div class="logo-container">
                <i data-lucide="sprout" class="welcome-logo"></i>
            </div>
            <h1 id="typewriter-text"></h1>
            <p class="welcome-subtitle">Smart farming at your fingertips.</p>
            
            <button id="proceed-btn" class="arrow-btn">
                <span>Go to Dashboard</span>
                <i data-lucide="arrow-right"></i>
            </button>
        </div>
        
        <div class="welcome-footer">
            <button id="backup-btn" class="btn-secondary">
                <i data-lucide="download"></i> Backup
            </button>
            <button id="restore-btn" class="btn-secondary">
                <i data-lucide="upload"></i> Restore
            </button>
        </div>
    </section>

    <!-- Main App Layout (Hidden initially) -->
    <main id="app-container" class="hidden">
        <header class="app-header">
            <div class="farm-info">
                <h2 id="display-farm-name">Green Pastures</h2>
                <span id="display-location"><i data-lucide="map-pin"></i> Nairobi, KE</span>
            </div>
            <button id="theme-toggle" class="icon-btn">
                <i data-lucide="moon"></i>
            </button>
        </header>

        <!-- View Sections -->
        <div id="view-content">
            <!-- Dashboard View -->
            <section id="dashboard-view" class="view active">
                <div class="kpi-grid">
                    <div class="kpi-card glass pink">
                        <small>Daily Milk</small>
                        <h3 id="kpi-daily-milk">0 L</h3>
                    </div>
                    <div class="kpi-card glass blue">
                        <small>Monthly Avg</small>
                        <h3 id="kpi-monthly-avg">0 L</h3>
                    </div>
                    <div class="kpi-card glass green">
                        <small>Revenue</small>
                        <h3 id="kpi-revenue">$0</h3>
                    </div>
                    <div class="kpi-card glass orange">
                        <small>Herd Health</small>
                        <h3 id="kpi-health-status">Good</h3>
                    </div>
                </div>

                <div class="chart-section">
                    <div class="section-header">
                        <h4>Milk Production</h4>
                        <div class="toggle-container">
                            <span class="toggle-label">Monthly</span>
                            <label class="switch">
                                <input type="checkbox" id="annual-toggle">
                                <span class="slider round"></span>
                            </label>
                            <span class="toggle-label">Annual</span>
                        </div>
                    </div>
                    <canvas id="productionChart" height="200"></canvas>
                </div>

                <div class="insights-section">
                    <h4>Smart Insights</h4>
                    <div id="insights-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Other views placeholder -->
            <section id="history-view" class="view hidden">...</section>
            <section id="finance-view" class="view hidden">...</section>
            <section id="health-view" class="view hidden">...</section>
            <section id="reports-view" class="view hidden">...</section>
            <section id="settings-view" class="view hidden">...</section>
        </div>

        <!-- Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-view="dashboard">
                <i data-lucide="layout-dashboard"></i>
                <span>Dash</span>
            </button>
            <button class="nav-item" data-view="history">
                <i data-lucide="history"></i>
                <span>History</span>
            </button>
            <button class="nav-item" data-view="finance">
                <i data-lucide="wallet"></i>
                <span>Finance</span>
            </button>
            <button class="nav-item" data-view="health">
                <i data-lucide="heart-pulse"></i>
                <span>Health</span>
            </button>
            <button class="nav-item" data-view="reports">
                <i data-lucide="file-text"></i>
                <span>Reports</span>
            </button>
            <button class="nav-item" data-view="settings">
                <i data-lucide="settings"></i>
                <span>Settings</span>
            </button>
        </nav>

        <!-- Floating Action Button -->
        <button id="fab-trigger" class="fab">
            <i data-lucide="plus"></i>
        </button>
    </main>

    <!-- Modals & Overlay -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div id="record-modal" class="bottom-sheet">
            <div class="sheet-header">
                <h3>Add New Record</h3>
                <button class="close-modal"><i data-lucide="x"></i></button>
            </div>
            <div class="option-grid">
                <button class="option-btn" onclick="openForm('production')">
                    <i data-lucide="milk" style="color: #3498db;"></i>
                    <span>Milk Production</span>
                </button>
                <button class="option-btn" onclick="openForm('finance')">
                    <i data-lucide="dollar-sign" style="color: #27ae60;"></i>
                    <span>Financial</span>
                </button>
                <button class="option-btn" onclick="openForm('health')">
                    <i data-lucide="stethoscope" style="color: #e74c3c;"></i>
                    <span>Health Event</span>
                </button>
                <button class="option-btn" onclick="openForm('inventory')">
                    <i data-lucide="package" style="color: #f39c12;"></i>
                    <span>Inventory</span>
                </button>
            </div>
        </div>
    </div>

    <script src="db.js"></script>
    <script src="utils.js"></script>
    <script src="app.js"></script>
    <script>
        // Initialize Lucide Icons
        lucide.createIcons();
        
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js');
            });
        }
    </script>
</body>
</html>
